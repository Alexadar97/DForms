<app-spinner *ngIf="loading"></app-spinner>
<div class="col-md-2" style="padding: 0;
background-color: #242536; height: 100vh;">
<div style="margin-top: 15px;">
    <p class="sidetext"(click)="umcslists()"  routerLinkActive="active" ><i class="fa fa-angle-double-right"></i>&nbsp;&nbsp;UMCS List</p>
    <p class="sidetext" (click)="addsto()"routerLinkActive="active" ><i class="fa fa-plus"></i>&nbsp;&nbsp;New
                Request</p>
     
            <p class="sidetext active"*ngIf="!isStoreLogin"(click)="upload()" routerLinkActive="active"><i class="fa fa-upload"></i>&nbsp;&nbsp;Upload
                Partlist</p>
          
        
            
    </div>
</div>
<div class="col-md-10">
<div class="row">
    <div class="col-md-4">
        <h4>Used Material Credit Slip</h4>
    </div>
    <div class="col-md-6"></div>
    <div class="col-md-2" style="padding-right: 40px;">
       
    </div>
</div>
<div class="row" style="
      padding: 10px;
      width: 100%;">

    <form [formGroup]="form">

        <div class="">
            <div class="row">


                <div class="col-md-3">

                    Purpose
                    <dot></dot>
                    <ng-container *ngIf="isShowValue == false">
                    <input type="text" class="form-control" value="" formControlName="storagePurpose" placeholder="Purpose/Project">
                    </ng-container>
                    <ng-container *ngIf="isShowValue == true">
                        <input type="text" class="form-control" value="" formControlName="storagePurpose" placeholder="Purpose/Project" disabled>
                        </ng-container>
                    <small class="text-danger errormsg" *ngIf="
                !form.controls.storagePurpose.valid &&
                form.controls.storagePurpose.touched
              ">Purpose is required</small>
                </div>

                <div class="col-md-3">

                    HR ID
                    <dot></dot>
                    <ng-container *ngIf="isShowValue == false">
                    <input type="text" class="form-control" value="" formControlName="hrid" placeholder="HR/1234">
                        </ng-container>
                        <ng-container *ngIf="isShowValue == true">
                            <input type="text" class="form-control" value="" formControlName="hrid" placeholder="HR/1234" disabled>
                                </ng-container>
                    <small class="text-danger errormsg" *ngIf="
                !form.controls.hrid.valid &&
                form.controls.hrid.touched
              ">HR ID is required</small>

                </div>

                <div class="col-md-3">

                    Contact Mobile Number
                    <dot></dot>
                    <ng-container *ngIf="isShowValue == false">
                    <input type="number" class="form-control" value="" formControlName="contactno" maxlength="10">
                        </ng-container>
                        <ng-container *ngIf="isShowValue == true">
                            <input type="number" class="form-control" value="" formControlName="contactno" maxlength="10" disabled>
                                </ng-container>
                    <small class="text-danger errormsg" *ngIf="
                !form.controls.contactno.valid &&
                form.controls.contactno.touched
              ">Contact Number is not valid</small>

                </div>

                <!-- <div class="col-md-3">

                    Department
                    <dot></dot>
                    <select class="form-control" name="" id="" formControlName="deptid">
                        <option value=null selected disabled>Select Department</option>
                        <ng-container *ngFor="let data of deptList;let index = index ; ">
                            <option value={{data?.id}}>{{data.name}}</option>
                        </ng-container>
                    </select>

                    <small class="text-danger errormsg" *ngIf="
                !form.controls.deptid.valid &&
                form.controls.deptid.touched
              ">Department is required</small>


                </div> -->

            </div>

            <div class="row">


                <div class="col-md-3">
                    <div class="Period">
                        Period of Storage
                        <span style="color:red;font-size: 18px;">*</span>
                        <ng-container *ngIf="isShowValue == false">
                        <select name="" id="" class="form-control" formControlName="storagePeriod">
                            <option value=null selected disabled> Select Period of Storage</option>
                            <option value="1month">Less than 1 Month</option>
                            <option value="2months">More than 1 Month and Less than 3 Months</option>
                            <option value="3months">Greater than 3 Months</option>
                        </select>
                        </ng-container>
                        <ng-container *ngIf="isShowValue == true">
                            <select name="" id="" class="form-control" formControlName="storagePeriod" disabled>
                                <option value=null selected disabled> Select Period of Storage</option>
                                <option value="1month">Less than 1 Month</option>
                                <option value="2months">More than 1 Month and Less than 3 Months</option>
                                <option value="3months">Greater than 3 Months</option>
                            </select>
                            </ng-container>
                        <small class="text-danger errormsg" *ngIf="
                    !form.controls.storagePeriod.valid &&
                    form.controls.storagePeriod.touched
                  ">Period of Storage is required</small>
                    </div>


                </div>
                <div class="col-md-3" *ngIf="isShowValue == false">
                    <div class="Period1">
                        <label> Scrap Note </label>
                        <dot></dot>
                        <label for="uploadFilePartid2" class="btn btn-md addnew btn-primary pdf">
                            Select File</label>
                        <input type="file" id="uploadFilePartid2" #uploadFilePartid style="display: none;"
                            (change)="uploadfile2($event)" accept="application/pdf" formControlName="pdfupload">
                        <span class="filename"> {{fileName2}}</span>

                        <!-- <small class="text-danger errormsg" *ngIf="
                              !form.controls.storagePeriod.valid &&
                              form.controls.storagePeriod.touched
                            ">Period of Storage is required</small> -->
                    </div>
                </div>
                <!-- <div class="col-md-3" *ngIf="form.controls.storagePeriod.value=='1month'">
                    <div class="Period">
                        <label>Approved by L4 </label>
                        <select class="form-control" name="" id="" formControlName="approverid">
                            <ng-container *ngFor="let data of l4Users;let index = index ; ">
                                <option value={{data?.shortid}}>{{data.shortid}}</option>
                            </ng-container>
                        </select>

                    </div>
                </div>
                <div class="col-md-3" *ngIf="form.controls.storagePeriod.value=='2month'">
                    <div class="Period">
                        <label>Approved by Proto Head </label>
                        <select class="form-control" name="" id="" formControlName="approverid">
                            <ng-container *ngFor="let data of l3Users;let index = index ; ">
                                <option value={{data?.shortid}}>{{data.shortid}}</option>
                            </ng-container>
                        </select>
                    </div>
                </div>
                <div class="col-md-3" *ngIf="form.controls.storagePeriod.value=='3month'">
                    <div class="Period">
                        <label>Approved by VP R&D </label>
                        <select class="form-control" name="" id="" formControlName="approverid">
                            <ng-container *ngFor="let data of l2Users;let index = index ; ">
                                <option value={{data?.shortid}}>{{data.shortid}}</option>
                            </ng-container>
                        </select>
                    </div>
                </div> -->

            </div>
        </div>

        <hr>
        




   
    <br><br>
    <div class="row" *ngIf="isShowValue == false">

        <div class="col-md-12">
            <div class="Period nopadding">
                <label for="uploadFilePartidl" class="btn btn-md addnew btn-primary">
                    Select File</label>
                <input type="file" id="uploadFilePartidl" #uploadFilePartid style="display: none;"
                    (change)="uploadfile1($event)"
                    accept="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet,application/vnd.ms-excel" formControlName="fileupload">
                <span class="filename"> {{fileName1}}</span>
            </div>

            <div class="col-md-12 nopadding">
                <a download href="assets/UMCS_template.xlsx">Download Template <i class="fas fa-cloud-download-alt"
                        style="font-size: 16px;color: #000000;"></i></a>
            </div>
        </div>
    </div>


    <div class="row" *ngIf="isShowValue == true">
        <div class="col-md-12">
          <table id="umcs_table" class="table table-bordered">
            <tr class="tableheader">
              <th>S.No</th>
              <th>Part No <dot></dot>
              </th>
              <th>Description <dot></dot>
              </th>
              <th>Parts Removed From Vehicle No <dot></dot>
              </th>
              <th>Quantity <dot></dot>
              </th>
            </tr>
            <tbody formArrayName="umcsPartsDummy">
              <tr class="tablerow" *ngFor="let row of rowForms.controls;let i =index" [formGroupName]="i">
                <td style="text-align: center;">
                  {{(i+1)}}
                </td>
  
                <td>
                  <input type="text" disabled class="form-control" formControlName="partnumber" minlength="8" maxlength="15"(keypress)="nospace($event)">
  
                  <small class="text-danger errormsg" *ngIf="
                        !row.controls.partnumber.valid &&
                        row.controls.partnumber.touched
                      ">Part Number is required <br>(Should be minimum 8 characters)</small>
                </td>
                <td>
                  <input  disabled type="text" class="form-control" formControlName="description">
  
                  <small class="text-danger errormsg" *ngIf="
                        !row.controls.description.valid &&
                        row.controls.description.touched
                      ">Description is required</small>
                </td>
                <td> <input  disabled type="text" class="form-control" formControlName="vehicleno">
  
                  <small class="text-danger errormsg" *ngIf="
                        !row.controls.vehicleno.valid &&
                        row.controls.vehicleno.touched
                      ">Vehicle Number is required</small></td>
  
                <td> <input disabled type="number" class="form-control" formControlName="quantity" minlength="1"  (keypress)="keyAlpha($event)">
  
                  <small class="text-danger errormsg" *ngIf="
                                      !row.controls.quantity.valid &&
                                      row.controls.quantity.touched
                                    ">Quantity is required</small></td>
                                 </tr>
  
            </tbody>
         </table>
  
        </div>
      </div>


</form>

    <div style="text-align: right;" *ngIf="isShowValue == false">
         <button class="btn btn-primary" (click)="submitForm()">Preview</button>
         </div>

         <div style="text-align: right;">
            <button class="btn btn-primary btn-md" (click)="uploadCancel()" *ngIf="isShowValue == true"><i
                class="fa fa-times"></i>&nbsp;&nbsp;Cancel</button>
            &nbsp;&nbsp;&nbsp;
            <button class="btn btn-primary btn-md" (click)="uploadConfirm()" *ngIf="isShowValue == true"><i
                class="fa fa-save"></i>&nbsp;&nbsp;Confirm</button>
          </div>

</div>
</div>



<!-- confirm modal -->

<div class="modal fade" id="confirmSubmit" role="dialog" data-backdrop="static" data-keyboard="false">
    <div class="modal-dialog modal-sm">
      <div class="modal-content">
        <div class="modal-body">
          <div class="row">
            <div class="col-md-10">
              <p class="modalHeader"  style="font-weight: 600;">Preview</p>
            </div>
            <div class="col-md-2">
              <button type="button" class="close" data-dismiss="modal">&times;</button>
            </div>
            <br>
            <div class="col-md-12">
              <p> Are you sure to preview the form ?</p>
            </div>
          </div>
        </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-sm btn-primary" data-dismiss="modal">No </button>
        <button type="button" class="btn btn-sm btn-primary" (click)="confirmSubmit()">Yes</button>
      </div>
    </div>
    </div>
  </div>





  
<!-- upload cancel modal -->

<div class="modal fade" id="cancelUpload" role="dialog" data-backdrop="static" data-keyboard="false">
    <div class="modal-dialog modal-sm">
      <div class="modal-content">
        <div class="modal-body">
          <div class="row">
            <div class="col-md-10">
              <p class="modalHeader" style="font-weight: 600;">Cancel</p>
            </div>
            <div class="col-md-2">
              <button type="button" class="close" data-dismiss="modal">&times;</button>
            </div>
            <br>
            <div class="col-md-12">
              <p> Are you sure to cancel the form ?</p>
            </div>
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-sm btn-primary" data-dismiss="modal">No </button>
          <button type="button" class="btn btn-sm btn-primary" (click)="confirmCancel()">Yes</button>
        </div>
      </div>
    </div>
  </div>
  
  
  
<!-- upload confirm modal -->

<div class="modal fade" id="confirmUpload" role="dialog" data-backdrop="static" data-keyboard="false">
  <div class="modal-dialog modal-sm">
    <div class="modal-content">
      <div class="modal-body">
        <div class="row">
          <div class="col-md-10">
            <p class="modalHeader" style="font-weight: 600;">Confirm</p>
          </div>
          <div class="col-md-2">
            <button type="button" class="close" data-dismiss="modal">&times;</button>
          </div>
          <br>
          <div class="col-md-12">
            <p> Are you sure to confirm the form ?</p>
          </div>
        </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-sm btn-primary" data-dismiss="modal">No </button>
        <button type="button" class="btn btn-sm btn-primary" (click)="confirmUploadForm()">Yes</button>
      </div>
    </div>
  </div>
</div>

